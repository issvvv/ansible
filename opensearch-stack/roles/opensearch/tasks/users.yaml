---
- name: Create service group
  become: true
  ansible.builtin.group:
    name: "{{ opensearch_server_service_group }}"
    state: present
    system: true
  when: opensearch_server_service_group != "root"

- name: Create service user
  become: true
  ansible.builtin.user:
    name: "{{ opensearch_server_service_user }}"
    group: "{{ opensearch_server_service_group }}"
    shell: /usr/sbin/nologin
    system: true
    createhome: false
  when: opensearch_server_service_user != "root"
